 Hello everybody. Today we're going to talk about merging, joining, and concatenating data frames in pandas. This whole video is basically around being able to combine two separate data frames together into one data frame. These are really important to understand when we're actually using the merge and the join. Right here we have what's called an inner join and the shaded part is what's going to be returned. It's only the things that are in both the left and the right data frames. Then we have an outer join or a full outer join and this will take all the data from the left data frame and the right data frame and everything that is similar. Basically it just takes everything. We also have a left join which is going to take everything from the left and then if there's anything that's similar it'll also include that. Then the exact opposite of that is the right join which is going to give us everything from the right data frame and it's going to give us everything that is similar but it's not going to give us anything that is just unique to the left data frame. This is just for reference because in a little bit when we start merging these these become very important. Just wanted to show you how that works visually. Let's get started by pulling in our files. First we're going to say import and as as pd. We'll run this and then we'll say data frame one and we'll also have a data frame two and these are the different data frames. The left and the right data frame that we'll be using to join merge and concatenate. We'll say data frame one is equal to pd.csv underscore read and we'll do r and here is our file path. So we have this lotr.csv that's our Lord of the Rings csv and let's call that really quickly so we can see what's in there and I'm having a dyslexic moment because it's supposed to be read underscore csv. I apologize for that but this is our data frame. This is our data frame one. We have three columns. It's their fellowship ID one thousand one two three and four. Their first name, Frodo Samwise, Gaelph, and Pipim and their skills hiding, gardening spells and fireworks. So this is our very first data frame that we're going to be working with. Let's go down a little bit. Let's pull this down here and we're just going to say day frame two, day frame two and this is the Lord of the Rings two. So let's pull this one in now. As you can see it's very similar. We have fellowship ID one two six seven eight. So we have three different IDs here. We don't have six seven and eight in this upper or this first data frame. We also have the first name. So Frodo and Sam or Samwise are in the very first and the second data frame. But now we have three new people, Baramir, Elrond and Legolas and now we have this age column which again is unique to just this second data frame. Really quickly I want to give a huge shout to these sponsors of this video and that is Zendesk. I've been using Zendesk for my company's customer analytics and his been absolutely phenomenal. They're going to be hosting a conference called Zendesk Relate on May 10th and they're going to talk all about customer analytics, chatbots and AI in this space. You can attend in person in San Francisco or you can attend virtually but space is limited so be sure to apply if you want to attend. So if you are a business leader and you want to make the most out of your customer data or you want to learn customer data analytics, I believe links in the description. Again, huge shout to Zendesk for sponsoring this video. Now the first one that I want to look at is merge. And I want to look at merge first because I think this one is the most important. I use this one more than any of the ones that we're going to talk about today. The merge is just like the joins that we were just looking at. The outer, the inner, the left and the right. And there's also one called cross and I'll show you that one although if I'm being honest, I don't really use that one that much but it's worth showing just in case you come into a scenario where you do want to do that. So let's go right down here and I want to be able to see these while we do it. So we're going to say data frame one and when we specify data frame one as the very first data frame, we say data frame dot merge. This is automatically going to be our left data frame. Then if we do our parentheses right here and we say data frame two, this is our right data frame. And let's see what happens when we do this. So what it's going to do in this, we didn't specify this is just a default. It's going to do an inner join. So it's only going to give us an output where specific values or the keys are the same. Now you can't see this but what is happening is it's taking this fellowship ID and saying I have one thousand and one here, a one thousand and two here. This is the exact same as up here with this fellowship ID and fellowship ID of one thousand one and two. But when we look at one thousand three and four, those aren't in this right data frame and six seven eight is not in this left data frame. So the only ones that match are this one thousand one and two and that's why they get pulled in down here. But because we didn't explicitly say here's what I want to join or merge between these two data frames, it actually is looking at the fellowship ID and the first name. So it's taking in these unique values of photo and same wise, which are the same in both, which is why I pulled it over. But really quickly, let's just check and make sure that we did it on the inner join because again, we didn't specify anything. That was just the default. So we're going to say how is equal to and then we'll say inner and if we run this, it's going to be the exact same because again, the inner is the default. But now just to show you how it's kind of joining these two data frames together, I'm going to say on is equal to and then I'm only going to put fellowship ID. So let's run this. Now the first thing that you may have noticed is this first name underscore X and this first name underscore Y. What the merge does as kind of a default is when you are only joining on a fellowship ID, we have this right data frame with fellowship ID, the left data frame with the fellowship ID. If you're just joining on these and you're not joining on the first name and the first name, then it's going to separate those into an underscore X and an underscore Y and even though they have the exact same values, since we are not merging on that column, it automatically separates that into two separate columns so we can see the values within each of those columns. If we went into this on and we make a list, let's do like that, and we say comma and then we write first name, oops, first name and then we run this. It's going to look exactly like it did before. Again, it automatically pulled in both of these columns when it was merging at the first time, even though we didn't write anything. But if we actually write this, it's doing exactly what it was doing when we just had DF2, we're just now writing it out. Now there are other arguments that we can pass into this merge function. Let's hit shift tab and let's scroll down here. So within this merge function, we have a lot of different arguments that you can pass into it. First, we have this right, which is the right day of frame, which is this day of frame two. Then we have the how and the on, which we've already shown how to do. There's a left on, right on, left index, right index, not something you'll probably use that much, but you definitely can, if you want to look into that. And there's all these doc strings which show you exactly how to use all of these. So if you're interested in looking at the left and the right and the left index, it's all in here. But one that is really good is the sort and you can sort it saying either it's false or true. Then we have these suffixes. Now, if you remember when we took these out, what it automatically did was it put in these underscore x and underscore y, you can customize that and you can put in whatever you'd like instead of the underscore x and underscore y, you can put in some custom string for that. We also have an indicator and a validates. Again, all things that you can go in here and look at, I'm just going to show you the stuff that I use the most. So these things right here are things that I definitely use the most. So now that we've looked at the inner join, let's copy this right down here and let's look at the outer join and he's get a little bit more tricky. I think the inner join is probably the easiest one to understand. Let's look at the outer this build OUTER. I don't know why I always want to say OUTER. But let's run this and see what we get. So now this looks quite different. The inner join only gave us the values that are the exact same. This one is going to give us all of the values regardless of if they are the same. So we have one, two, three, four, six, seven, and eight. So let's go back up here. So we have one, two, three, four, one, two, and six, seven, and eight. So we don't have a one thousand and five. And then if you notice in this data frame right here, if the value doesn't have, so if we can't join on the fellowship ID or the first name, like a legolas wasn't one that we joined on or that has a similar value in the left data frame, it just gives us an NAN, which is not a number. And it's going to do that for any value where it couldn't find that join or it couldn't match something within that either ID or first name. So in age, we also have that for the ones that weren't in the right data frame. We only had one thousand and one and one thousand two. So we'll have the age for both photo and Sam, but for Gandalf and Pippin, we don't have their corresponding IDs. And so it's just going to be blank for Gandalf and Pippin. And you can see that right here. So again, outer joins are kind of the opposite of inner joins. They're going to return everything from both. If there is overlapping data, it won't be duplicated. Now let's go on to the left join. And I'm going to pull this down right here. And now we're just going to say how is equal to left? And let's run this. So what this is going to do is it's going to take everything from the left table or the left data frame right here. So everything is from data frame one. Then if there is any overlap, it'll also pull the overlap to the, you know, whatever we're able to merge on from data frame two. So let's go back up to our data frame one and two. So it's going to pull everything from this left data frame because we're specifying we're doing a left join. So everything from the left data frame will be in there. We're also going to try to bring in everything from the right. But only if it matches or is able to merge. So just this information right here will come over. We weren't able to join on 106, 107 or 108. So really none of that information is going to come over. So let's go down and check on this. So again, we have one, two, three, four, all of the data with this first name and skills. Everything is in here. But then we are trying to bring over the age, but we only have matches with one thousand one and one thousand two. So only these two values will come in. Let's look at the right join because it's basically the exact opposite. Let's look at the right. And this is basically the exact opposite of the left in the fact that now we're only looking at the right hand. And then if there's something that matches in data frame one, then we will pull that in. So this is basically just looking like data frame two, except we're pulling in that skills column. And since only one thousand and one thousand and two are the same, that's why the skills values are here. Now, those are the main types of merges that I will use when I'm using a data frame. Or when I'm trying to merge a data frame, but there also is one called a cross or a cross join. And let's look at this one. And this one is quite a bit different. Here we go. Let's run this. So this one is different in that it takes each value from the left data frame and compares it to each value in the right data frame. So for Frodo in this left data frame, it looks at the Frodo in the right data frame. Samwise in the right data frame, legless, Elron and Baramir, all in the right data frame. Then it goes to the next value. Samwise does the exact same thing. Frodo, Samwise, legless, Elron, Baramir. And it does that for every single value. So let's go right back up here. So it's taking this this one thousand and one. It's comparing it to one two three four five. Then it's taking Samwise. It's comparing it to one two three four five. And off one two three four five. Pippin. And then you kind of see that pattern. And that's what a cross join is. There are very few in my opinion reasons for a cross join. Although you'll, if you ever do like an interview where you're being interviewed on Python, you will sometimes be asked on cross joins. But there aren't a lot of instances in actual work where you really use or need a cross join. Now let's take a look at joins and joins are pretty similar to the merge function. And it can do a lot of the same thing except in my opinion, the join function isn't as easily understood as the merge function. It's a little bit more complicated. But let's take a look and see how we can join together these data frames using the join function. So let's go right up here. We're going to say data frame one dot join. And then we'll do data frame two very similar to how we did it before. And let's try running this. And it's not going to work. When we did the merge function, it had a lot of defaults for us. Let's go down and see what this error is. It says the columns overlap, but no suffix was specified. So it's telling us that it's trying to use the fellowship ID and the first name, just like the join did, except it's not able to distinguish which is which. And so we need to go in there and kind of help it out a little bit again, a little bit more hands on than the merge. But let's see what we can do to make this work. Let's do comma. And we'll say on. And let's really quickly let's open this up and kind of see what we have. So this one has less options than the merge does. We have other. And that's our other data frame. We can do on and we're going to specify, you know, what column do we want to join on? And then we can look at how do we want it to be a left and enter an outer, the same kind of types of joins as the merge. Then we have that left suffix, right suffix. And that's right here is kind of part of the issue that we were just facing is that those columns are the same. But if we say left suffix, it'll give us an underscore, whatever we want to specify any string, four columns that are both and the left and the right. We can give it a unique name. So we'll no longer have that issue. And then we can also sort it like we did on the other one. But anyways, let's go back to our on. We'll say on is equal to and then we'll say fellowship ID. Let's try running this. And we're still getting an error. It's just not as simple as the merge. So let's keep going. So now let's specify the type. So we'll say how is equal to and we'll do an outer. And if we run this, it still doesn't work. We're still getting the exact same issue as the less suffix and the right suffix. So now let's finally resolve it. I just wanted to show you how a little bit more frustrating it was. But now let's say L suffix is equal to. And now it automatically when we did the merge did an underscore X. But we can do let's do underscore left. And then we can do a comma, do right suffix. And we'll say is equal to and we'll do underscore right now when we run this, it should work properly. Let's run this. So this is our output and obviously it looks quite a bit different. Over here, we have this fellowship ID. Then we also have fellowship ID left first name left fellowship ID right and first name right. So it just doesn't look right. Now, something I didn't specify when I first started this because I kind of wanted to show you is that the join usually is better for when you're working with indexes. Before when we were using the merge, we were using the column names and that worked really well and is pretty easy to do. But as you can see right here when we're trying to use these column names, it's not working exceptionally well. Let's go ahead and create our index. And then I can show you how this actually works and how it works a little bit better when we're working with just the index. Although you can get it to work just the same as the merge. It's just a lot more work. So let's go right down here. And let's go and say df4. So we'll create a new data frame. We'll say df1.set underscore index and we'll do an open parentheses and we'll say we want to do this index on the fellowship ID. And then we're going to do the join. So now we're going to say join. So we're setting an index. So we're setting that index on the fellowship ID. Now we're going to join it on df2.set underscore index. And then we're also going to do that on the fellowship ID and I'll just copy this. Oh geez. I hate it when I do that. Okay. Now we also want to do specify the left and the right index. So I'll just copy this as we do need to specify this. Now let's try running the data frame for. So really quickly just to recap, we were setting the indexes. We were doing the same thing above. Right. We have this join. We were joining data frame one with data frame two. Now we're joining data frame one with data frame two, except in both instances, we're setting the index as fellowship ID. So we're joining now on that index. So now let's run this. And this should look a lot more similar to the merge than the join that we did above. Except now the fellowship ID right here is actually an index. So it's just a little bit different. But we can still go in here and do how is equal to outer. Oops. Let's say outer. So we can still specify our different types of joins or the different way that we can merge or join these data frames together. We can still specify that. Again, it's just a little bit different. And that's why for most instances, I'm using that merge function because it's just a little bit more seamless, a little bit more intuitive. The join function can still get the job done. But as you can see, it takes a little bit more work. Now let's look at concatenate concatenating data frames can be really useful. And the distinction between a merge and join versus the concatenate is that the concatenate is kind of like putting one data frame on top of the other rather than putting one data frame next to one another, which is like the merge and the join. So concatenating them is just a little bit different and how it'll operate. But let's actually write this out and see how this looks. Let's go up here and we'll say pd.cancat. We'll do an open parentheses. And then we're going to concatenate data frame one, ama, data frame two. That's all we have to write. And let's run this. And so just like I said, it literally took the first data frame, one, two, three, four and put it on top of the right data frame, one, two, six, seven, eight. So that is our left data frame. This is our right data frame. And they're literally just sitting one on top of the other. But just like when we merge either with a left or a right, when you have these skills and there aren't any values that populate for them, it is going to say not a number. And since we're not actually joining, we're not joining on one and two, even though this one and this one is the same rows, it's not populating that value because again, we're not joining these together. We're just concatenating and putting one on top of the other. Now if we go into this concaten, we say shift tab, there are a lot of different things that we can do, which if you remember the zero axis is the left hand index and the axis of one is the top index, which is the columns. So you can specify that. And we can also do joins. And this is the one that I'm going to take a look at. But there are other ones that you can look into as well. But let's look at join. Let's do comma. And we'll say join is equal to. And let's do an inner join. So let's see what happens with this. As you can see, it is only taking the columns that are the same. That's what this inner is doing. It's joining these columns together. And the ones that were different, they didn't take because again, we weren't able to combine them. They aren't similar between both data frames. Let's do an outer. And now it's going to take all of them. And like I said, that's doing this on these columns right here. But we can also do it on this axis as well. So let's go ahead and say axis is equal to one. And when we run this, now it's joining us on this index right here of zero, one, two, three, four. So now these ones are being joined together. And it's putting it side by side much like a merge wood. So that's how concatenate works. And I'm going to show you one more thing. And again, it's not up here in this title because it's not one that I recommend, but it's one called append. The append function is used to append rows from one data frame to the end of another data frame. And then we can return that new data frame. And so let's do data frame one dot append to an open parentheses. And we'll say data frame two, very similar to how we've been doing other things. And let's run this. And as you can see, this is almost exactly like how the concatenate did when we first did it. But if we read kind of this warning, it's saying the frame dot append method is deprecated and will be removed from pandas in the future version, use pandas.cancate instead. So it's literally warning us, you know, append is on its way out. If you want to do exactly what you're doing right here, go and try concatenate because that'll do the exact same thing. So I'm not really going to show you any other variations of append because there's no reason it's going to be on its way out in the next version. So that is our video on merge, join and concatenate and append as well in pandas. And I hope that that was helpful. I hope that you learned something. I mean, this stuff is really important because oftentimes you're not just working with one CSV or one JSON or one text file, you're working with multiple of them and you need to combine them all into one data frame. And so this is a really, really important concept and thing to understand with that being said, be sure to like and subscribe. Check out all my other videos on Python and pandas. And I will see you in the next video.